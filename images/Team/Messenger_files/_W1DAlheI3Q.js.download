if (self.CavalryLogger) { CavalryLogger.start_js(["dWhaI"]); }

__d("VideoPlayerSpinner.react",["React","VideoPlayerHooks","XUISpinner.react","stylex"],(function(a,b,c,d,e,f){"use strict";var g=b("VideoPlayerHooks").useStalling;function a(){var a=g();return b("React").createElement("div",{className:"py2didcb rk01pc8j kfkz5moi pmk7jnqg"+(a?"":" b5wmifdl")},b("React").createElement(b("XUISpinner.react"),{size:"large"}))}e.exports=a}),null);
__d("XStoriesAsyncTrayController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/stories/tray/async/",{expanded:{type:"Bool",defaultValue:!1}})}),null);
__d("FBStoriesTrayReloadXHPTray",["AsyncRequest","XStoriesAsyncTrayController"],(function(a,b,c,d,e,f){"use strict";a={reloadTray:function(a){a=b("XStoriesAsyncTrayController").getURIBuilder().setBool("expanded",(a=a)!=null?a:!1).getURI();new(b("AsyncRequest"))().setURI(a).setMethod("GET").setReadOnly(!0).send()}};e.exports=a}),null);
__d("FantaHider",["ifRequired"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports={hide:function(){b("ifRequired")("FantaTabsSlimApp",function(a){a.hide()},function(){b("ifRequired")("FantaTabsReactApp",function(a){a.hide()})})},unhide:function(){b("ifRequired")("FantaTabsSlimApp",function(a){a.unhide()},function(){b("ifRequired")("FantaTabsReactApp",function(a){a.unhide()})})}}}),null);
__d("FBStoriesViewer2",["csx","cx","requireDeferred","Arbiter","ChatSidebarActions","ChatSidebarStore","CometStoriesPlaceholder.react","CSS","DOM","DOMQuery","FantaHider","FBLogger","FBStoriesTrayReloadXHPTray","PageTransitions","React","ReactDOM","StoriesEnums","StoriesGating","StoriesLoggingConstants","StoriesViewer2URI","URI","UserAgent","WebStorage","deferredLoadComponent"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("deferredLoadComponent")(b("requireDeferred")("StoriesViewerRoot.react")),j=b("deferredLoadComponent")(b("requireDeferred")("StoriesViewerSuspenseRoot.react")),k=b("deferredLoadComponent")(b("requireDeferred")("StoriesViewerSingleBucketRoot.react")),l="fb_stories_theater",m=4;a=function(){__p&&__p();a.getInstance=function(){this.$8||(a.$8=new a());return a.$8};a.open=function(b){a.getInstance().open(b)};function a(){__p&&__p();var a=this;this.$6=null;this.$7=null;this.$12=function(c){__p&&__p();if(b("StoriesViewer2URI").isValid(c))return!0;a.$9();a.$7&&a.$7.unsubscribe();var d=a.$6;if(d&&c.getQualifiedURI().toString()===d.getQualifiedURI().toString()){if(c.stripTrailingSlash().getPath()===""){d=b("WebStorage").getSessionStorage();c=d!=null?d.getItem("stories_tray_expanded"):"false";b("FBStoriesTrayReloadXHPTray").reloadTray(c=="true")}b("PageTransitions").transitionComplete();return!0}return!1};this.$1=!1;this.$3=b("DOMQuery").scry(document.body,"._li")[0]}var c=a.prototype;c.toggle=function(a,b){a?this.open(b):this.$9()};c.open=function(a){__p&&__p();var c=this,d=a.bucketID,e=a.cardID,f=function d(e){if(b("StoriesViewer2URI").isValid(e)===!1){b("FBLogger")("fbstories").mustfix("Stories Viewer Transition Handler hit with non story viewer URL with uri: "+e.getPath());return!1}b("PageTransitions").removeHandler(d,m);c.$10(a);b("PageTransitions").transitionComplete();return!0};b("PageTransitions").registerHandler(f,m);this.$6=b("PageTransitions").getCurrentURI();b("PageTransitions").go(b("StoriesViewer2URI").getURI(d,e))};c.navigateToEntryPoint=function(){this.$6&&b("StoriesViewer2URI").isValid(this.$6)&&(this.$6=new(b("URI"))("/")),this.$6?b("PageTransitions").go(this.$6):b("URI").go("/")};c.$11=function(a){__p&&__p();var c=a.bucketID,d=a.cardID,e=a.openSource,f=a.traySessionID;a=a.tilePosition;b("CSS").addClass(this.$3,"_72b0");document.body&&b("CSS").addClass(document.body,"_7d54");var g=b("DOM").create("div",{id:l});b("CSS").setClass(g,"_74r7");var h=b("DOM").create("div");b("DOM").appendContent(h,g);this.$4=h;this.$2=g;var m=b("StoriesGating").getBackgroundStyle();b("CSS").setClass(h,"_74r8");m===b("StoriesEnums").BACKGROUND_STYLE.BLACK86?b("CSS").addClass(h,"black86"):m===b("StoriesEnums").BACKGROUND_STYLE.BLACK90&&b("CSS").addClass(h,"black90");b("UserAgent").isBrowser("Edge")||b("CSS").addClass(h,"_7qac");b("DOM").appendContent(this.$3,h);m=null;e===b("StoriesLoggingConstants").ACTION_SOURCE.FACEBOOK_CHAT_TAB||e===b("StoriesLoggingConstants").ACTION_SOURCE.MESSENGER_DOT_COM?m=k:b("StoriesGating").shouldUseSuspenseVersionViewer()?m=j:m=i;h=c==="";b("ReactDOM").render(b("React").createElement(b("React").Suspense,{fallback:b("React").createElement(b("CometStoriesPlaceholder.react"),{isNullState:h})},b("React").createElement(m,{bucketID:c,cardID:d||"",fadeIn:!0,openSource:(h=e)!=null?h:b("StoriesLoggingConstants").ACTION_SOURCE.TRAY,traySessionID:f,tilePosition:a})),g)};c.openDialogMessenger=function(a){b("Arbiter").inform("jewel/hide");if(this.$1)return;this.$1=!0;this.$11(a)};c.$10=function(a){__p&&__p();var c=this,d=a.bucketID;d=d===void 0?"":d;var e=a.cardID,f=a.openSource,g=a.traySessionID;a=a.tilePosition;b("Arbiter").inform("jewel/hide");if(this.$1)return;this.$1=!0;this.$7=b("Arbiter").subscribe("page_transition",function(a,d){a=d.uri;if(b("StoriesViewer2URI").isValid(a))return;if(!c.$1){c.$7&&c.$7.unsubscribe();return}c.$12(a)});this.$11({bucketID:d,cardID:e,openSource:f,traySessionID:g,tilePosition:a});b("FantaHider").hide();b("ChatSidebarStore").isEnabled()?(this.$5=b("ChatSidebarStore").getVisibleType(),b("ChatSidebarActions").disable()):this.$5=null;b("PageTransitions").registerHandler(this.$12)};c.$13=function(){this.$2!=null&&(b("ReactDOM").unmountComponentAtNode(this.$2),this.$2=null),b("CSS").removeClass(this.$3,"_72b0"),document.body&&b("CSS").removeClass(document.body,"_7d54"),this.$4!=null&&(b("DOM").remove(this.$4),this.$4=null)};c.closeDialogMessenger=function(){if(this.$1===!1)return;this.$13();this.$1=!1};c.$9=function(){if(this.$1===!1)return;b("PageTransitions").removeHandler(this.$12);this.$13();b("FantaHider").unhide();this.$5!=null&&b("ChatSidebarActions").enable(this.$5);this.$1=!1};return a}();e.exports=a}),null);